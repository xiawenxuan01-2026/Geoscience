Bootstrap Analysis Package

A Python package for geoscience bootstrap resampling and time-binned analysis with flexible I/O, automatic age-range detection, and rich visualization.

Key Features
- Flexible data input: Any Excel file with customizable column names
- Auto age-range detection: Detects min/max ages considering measurement errors and a safety buffer
- Custom time interval: User-defined time interval (Ma) for binning; auto-suggestion available
- Intelligent interval suggestion: Proposes an interval targeting ~N bins from your data range
- Weighting: Distance-based weights in space and time (latitude, longitude, age)
- Bootstrap resampling: Efficient, vectorized bootstrapping with user-defined iterations
- Visualization: Mean curves, confidence bands, boxplots, heatmaps, weight and data summaries
- Statistics: Mean, std, median, min/max, and 68/90/95% confidence intervals
- Robust validation and error handling

Why This Package
- Performance: Vectorized weight calculation and bootstrap binning; scalable to larger datasets
- Usability: Works with arbitrary Excel schemas by mapping column names; optional auto time-range
- Reproducibility: Configurable random seed and iteration counts
- Extensibility: Modular architecture (`DataLoader`, `WeightCalculator`, `BootstrapProcessor`, `Plotter`)

Excel Data Requirements
- Age arrays non-negative; `age_max >= age`
- Probability in [0, 1]
- Latitude in [-90, 90], longitude in [-180, 180]
- Missing values are automatically filtered with a warning

API Overview
- `BootstrapAnalyzer.load_data(file_path, age_column, age_max_column, probability_column, lat_column, lon_column, sheet_name='Sheet1', skip_rows=0)`
- `BootstrapAnalyzer.calculate_weights()`
- `BootstrapAnalyzer.run_bootstrap_analysis(min_age=None, max_age=None, probability_threshold=0.5)`
- `BootstrapAnalyzer.plot_results(output_file='bootstrap_analysis.pdf', confidence_level=0.95, min_age=None, max_age=None)`
- `BootstrapAnalyzer.get_statistics()` â†’ dict of arrays
- `BootstrapAnalyzer.run_complete_analysis(...)` â†’ one-shot pipeline

Notes
- Seaborn is optional. If not installed, plots fall back to default matplotlib style.
- Ensure `time_interval > 0` and `min_age < max_age`. The processor guards against invalid bins.
- For very large datasets, consider lowering `iterations` or increasing `time_interval`.

Troubleshooting
- File/columns not found: verify sheet name and exact column headers
- Invalid ranges: ensure `age <= age_max` and valid lat/lon ranges
- Memory: reduce iterations, widen `time_interval`, or subset data

License
MIT

Changelog
- v1.0.0: Initial release with bootstrap analysis, visualization, validation